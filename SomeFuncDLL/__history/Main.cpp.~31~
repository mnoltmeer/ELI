#include <vcl.h>
#include <windows.h>
#include "..\MyFunc.h"
#include "eli_interface.h"

#pragma hdrstop
#pragma argsused

extern "C"
{
__declspec(dllexport) void __cdecl eIsStrNum(void *p)
{
  ELI_INTERFACE *ep = (ELI_INTERFACE*)p;

  UINT i = IsStrNum(ep->GetParamToStr(L"pStr"));

  wchar_t res[3];
  swprintf(res, L"%d", i);

  ep->SetFunctionResult(ep->GetCurrentFuncName(), res);
}
//-------------------------------------------------------------------------------

__declspec(dllexport) void __cdecl eGetCurrDateToStr(void *p)
{
  ELI_INTERFACE *ep = (ELI_INTERFACE*)p;

  String res = DateToStr(Date());
  ShowMessage(ep->GetCurrentFuncName());
  ep->SetFunctionResult(ep->GetCurrentFuncName(), res.c_str());
}
//-------------------------------------------------------------------------------

__declspec(dllexport) void __cdecl eGetCurrTimeToStr(void *p)
{
  ELI_INTERFACE *ep = (ELI_INTERFACE*)p;

  String res = TimeToStr(Time());

  ep->SetFunctionResult(ep->GetCurrentFuncName(), res.c_str());
}
//-------------------------------------------------------------------------------

__declspec(dllexport) void __cdecl eParseString(void *p)
{
  ELI_INTERFACE *ep = (ELI_INTERFACE*)p;

  String mstr = ep->GetParamToStr(L"pMainStr"),
  tstr = ep->GetParamToStr(L"pTargetStr"),
  istr = ep->GetParamToStr(L"pInsertStr");

  String res = ParseString(mstr, tstr, istr);

  ep->SetFunctionResult(ep->GetCurrentFuncName(), res.c_str());
}
//-------------------------------------------------------------------------------
}

int WINAPI DllEntryPoint(HINSTANCE hinst, unsigned long reason, void* lpReserved)
{
	return 1;
}

